"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _slicedToArray=function(){function e(e,t){var i=[],r=!0,n=!1,o=void 0;try{for(var s,a=e[Symbol.iterator]();!(r=(s=a.next()).done)&&(i.push(s.value),!t||i.length!==t);r=!0);}catch(e){n=!0,o=e}finally{try{!r&&a.return&&a.return()}finally{if(n)throw o}}return i}return function(t,i){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,i);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),_createClass=function(){function e(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,i,r){return i&&e(t.prototype,i),r&&e(t,r),t}}(),_wepy=require("./../../npm/wepy/lib/wepy.js"),_wepy2=_interopRequireDefault(_wepy),_regions=require("./../../utils/regions.js"),_regions2=_interopRequireDefault(_regions),AreaPicker=function(e){function t(){var e,i,r,n;_classCallCheck(this,t);for(var o=arguments.length,s=Array(o),a=0;a<o;a++)s[a]=arguments[a];return i=r=_possibleConstructorReturn(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(s))),r.data={provinces:[],cities:[],areas:[],defaultValue:[0,0,0],selectedRegion:[0,0,0],animationData:{},show:!1},r.methods={cancelPicker:function(){this.hidePicker()},onAddressPick:function(){this.hidePicker();var e=_slicedToArray(this.selectedRegion,3),t=e[0],i=e[1],r=e[2],n=this.provinces,o=this.cities,s=this.areas;this.province=n[t],this.city=o[i],this.area=s[r]||{},this.area||(this.area.name="",this.code.code=""),this.$emit("areaArray",this.province,this.city,this.area),this.$apply()},bindChange:function(e){var t=e.detail.value;this.cities=_regions2.default[t[0]].cities,this.areas=_regions2.default[t[0]].cities[t[1]].areas,this.selectedRegion[0]!=t[0]?this.selectedRegion=[t[0],0,0]:this.selectedRegion[1]!=t[1]?this.selectedRegion=[t[0],t[1],0]:this.selectedRegion=t,this.defaultValue=this.selectedRegion,this.$apply()}},n=i,_possibleConstructorReturn(r,n)}return _inherits(t,e),_createClass(t,[{key:"setAddressPickerValue",value:function(e,t,i){this.province=e,this.city=t,this.area=i,this.$apply()}},{key:"showPicker",value:function(){var e=_wepy2.default.createAnimation({duration:500,timingFunction:"ease"});this.fadeAnim=e;var t=_wepy2.default.createAnimation({duration:500,timingFunction:"ease"});this.showAnim=t,e.backgroundColor("#000").opacity(.5).step(),t.bottom("0rpx").step(),this.show=!0,this.animationData={fadeAnim:e.export(),showAnim:t.export()},this.$apply()}},{key:"hidePicker",value:function(){this.fadeAnim.backgroundColor("#fff").opacity(0).step(),this.showAnim.bottom("-600rpx").step(),this.show=!1,this.animationData={fadeAnim:this.fadeAnim.export(),showAnim:this.showAnim.export()},this.$apply()}},{key:"openAddressPicker",value:function(){this.initAddressPicker(),this.showPicker()}},{key:"initAddressPicker",value:function(e){for(var t=[],i=[],r=[],n=e||[0,0,0],o=this.province,s=this.city,a=this.area,c=0;c<_regions2.default.length;c++)t.push({name:_regions2.default[c].name,code:_regions2.default[c].code});t.some(function(e,t){if(o&&e.code==o.code)return n[0]=t,!0});var u=_regions2.default[n[0]].cities;if(u){for(var l=0;l<u.length;l++)i.push({name:u[l].name,code:u[l].code});i.some(function(e,t){if(s&&e.code==s.code)return n[1]=t,!0});console.log("执行了区级判断");var h=u[n[1]].areas;if(h){for(var f=0;f<h.length;f++)r.push({name:h[f].name,code:h[f].code});r.some(function(e,t){if(a&&e.code==a.code)return n[2]=t,!0})}else r.push(i[n[1]])}else i.push(t[n[0]]),r.push(t[n[0]]);this.provinces=t,this.cities=i,this.areas=r,this.defaultValue=n,this.selectedRegion=n,this.$apply()}},{key:"onLoad",value:function(){}}]),t}(_wepy2.default.component);exports.default=AreaPicker;